---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.18.0
  name: networkintents.nephoran.com
spec:
  group: nephoran.com
  names:
    kind: NetworkIntent
    listKind: NetworkIntentList
    plural: networkintents
    shortNames:
    - ni
    singular: networkintent
  scope: Namespaced
  versions:
  - name: v1
    schema:
      openAPIV3Schema:
        description: NetworkIntent is the Schema for the networkintents API
        properties:
          apiVersion:
            description: |-
              APIVersion defines the versioned schema of this representation of an object.
              Servers should convert recognized schemas to the latest internal value, and
              may reject unrecognized values.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
            type: string
          kind:
            description: |-
              Kind is a string value representing the REST resource this object represents.
              Servers may infer this from the endpoint the client submits requests to.
              Cannot be updated.
              In CamelCase.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
            type: string
          metadata:
            type: object
          spec:
            description: NetworkIntentSpec defines the desired state of NetworkIntent
            properties:
              constraints:
                additionalProperties:
                  type: string
                description: Constraints defines deployment constraints
                type: object
              intent:
                description: |-
                  Intent is the natural language intent from the user describing the desired network configuration.

                  SECURITY: This field implements defense-in-depth validation to prevent injection attacks:
                  1. Restricted character set - Only allows alphanumeric, spaces, and safe punctuation
                  2. Length limits - Maximum 1000 characters to prevent resource exhaustion
                  3. Pattern validation - Explicitly excludes dangerous characters that could enable:
                     - Command injection (backticks, $, &, *, /, \)
                     - SQL injection (quotes, =, --)
                     - Script injection (<, >, @, #)
                     - Path traversal (/, \)
                     - Protocol handlers (@, #)
                  4. Additional runtime validation in webhook for content analysis

                  Allowed characters:
                    - Letters: a-z, A-Z
                    - Numbers: 0-9
                    - Spaces and basic punctuation: space, hyphen, underscore, period, comma, semicolon, colon
                    - Grouping: parentheses (), square brackets []

                  Examples:
                    - "Deploy a high-availability AMF instance for production with auto-scaling"
                    - "Create a network slice for URLLC with 1ms latency requirements"
                    - "Configure QoS policies for enhanced mobile broadband services"
                maxLength: 1000
                minLength: 1
                pattern: ^[a-zA-Z0-9\s\-_.,;:()\[\]]*$
                type: string
              intentType:
                allOf:
                - enum:
                  - scaling
                  - deployment
                  - configuration
                  - optimization
                  - maintenance
                - enum:
                  - scaling
                  - deployment
                  - configuration
                  - optimization
                  - maintenance
                description: IntentType specifies the type of network intent
                type: string
              maxRetries:
                description: MaxRetries specifies the maximum number of retry attempts
                format: int32
                type: integer
              networkSlice:
                description: NetworkSlice identifies the network slice for this intent
                type: string
              parameters:
                description: Parameters contains structured parameters extracted from
                  the intent
                type: object
                x-kubernetes-preserve-unknown-fields: true
              parametersMap:
                additionalProperties:
                  type: string
                description: ParametersMap contains key-value parameters extracted
                  from the intent
                type: object
              priority:
                allOf:
                - enum:
                  - low
                  - normal
                  - high
                  - critical
                - enum:
                  - low
                  - normal
                  - high
                  - critical
                description: Priority defines the processing priority
                type: string
              processedParameters:
                description: ProcessedParameters contains parameters extracted during
                  processing
                type: object
                x-kubernetes-preserve-unknown-fields: true
              region:
                description: Region specifies the target region for deployment
                type: string
              resourceConstraints:
                description: ResourceConstraints defines resource constraints for
                  deployments
                properties:
                  maxCPU:
                    anyOf:
                    - type: integer
                    - type: string
                    description: Maximum CPU allocation as resource.Quantity (for
                      blueprint engine compatibility)
                    pattern: ^(\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))(([KMGTPE]i)|[numkMGTPE]|([eE](\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))))?$
                    x-kubernetes-int-or-string: true
                  maxCpu:
                    description: Maximum CPU allocation (string form for backward
                      compatibility)
                    type: string
                  maxMem:
                    description: Maximum memory allocation (string form for backward
                      compatibility)
                    type: string
                  maxMemory:
                    anyOf:
                    - type: integer
                    - type: string
                    description: Maximum memory allocation as resource.Quantity (for
                      blueprint engine compatibility)
                    pattern: ^(\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))(([KMGTPE]i)|[numkMGTPE]|([eE](\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))))?$
                    x-kubernetes-int-or-string: true
                  maxResources:
                    description: Maximum resource limits
                    properties:
                      claims:
                        description: |-
                          Claims lists the names of resources, defined in spec.resourceClaims,
                          that are used by this container.

                          This is an alpha field and requires enabling the
                          DynamicResourceAllocation feature gate.

                          This field is immutable. It can only be set for containers.
                        items:
                          description: ResourceClaim references one entry in PodSpec.ResourceClaims.
                          properties:
                            name:
                              description: |-
                                Name must match the name of one entry in pod.spec.resourceClaims of
                                the Pod where this field is used. It makes that resource available
                                inside a container.
                              type: string
                            request:
                              description: |-
                                Request is the name chosen for a request in the referenced claim.
                                If empty, everything from the claim is made available, otherwise
                                only the result of this request.
                              type: string
                          required:
                          - name
                          type: object
                        type: array
                        x-kubernetes-list-map-keys:
                        - name
                        x-kubernetes-list-type: map
                      limits:
                        additionalProperties:
                          anyOf:
                          - type: integer
                          - type: string
                          pattern: ^(\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))(([KMGTPE]i)|[numkMGTPE]|([eE](\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))))?$
                          x-kubernetes-int-or-string: true
                        description: |-
                          Limits describes the maximum amount of compute resources allowed.
                          More info: https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/
                        type: object
                      requests:
                        additionalProperties:
                          anyOf:
                          - type: integer
                          - type: string
                          pattern: ^(\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))(([KMGTPE]i)|[numkMGTPE]|([eE](\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))))?$
                          x-kubernetes-int-or-string: true
                        description: |-
                          Requests describes the minimum amount of compute resources required.
                          If Requests is omitted for a container, it defaults to Limits if that is explicitly specified,
                          otherwise to an implementation-defined value. Requests cannot exceed Limits.
                          More info: https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/
                        type: object
                    type: object
                  maxStorage:
                    description: Maximum storage allocation (string form for backward
                      compatibility)
                    type: string
                  minResources:
                    description: Minimum resource requirements
                    properties:
                      claims:
                        description: |-
                          Claims lists the names of resources, defined in spec.resourceClaims,
                          that are used by this container.

                          This is an alpha field and requires enabling the
                          DynamicResourceAllocation feature gate.

                          This field is immutable. It can only be set for containers.
                        items:
                          description: ResourceClaim references one entry in PodSpec.ResourceClaims.
                          properties:
                            name:
                              description: |-
                                Name must match the name of one entry in pod.spec.resourceClaims of
                                the Pod where this field is used. It makes that resource available
                                inside a container.
                              type: string
                            request:
                              description: |-
                                Request is the name chosen for a request in the referenced claim.
                                If empty, everything from the claim is made available, otherwise
                                only the result of this request.
                              type: string
                          required:
                          - name
                          type: object
                        type: array
                        x-kubernetes-list-map-keys:
                        - name
                        x-kubernetes-list-type: map
                      limits:
                        additionalProperties:
                          anyOf:
                          - type: integer
                          - type: string
                          pattern: ^(\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))(([KMGTPE]i)|[numkMGTPE]|([eE](\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))))?$
                          x-kubernetes-int-or-string: true
                        description: |-
                          Limits describes the maximum amount of compute resources allowed.
                          More info: https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/
                        type: object
                      requests:
                        additionalProperties:
                          anyOf:
                          - type: integer
                          - type: string
                          pattern: ^(\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))(([KMGTPE]i)|[numkMGTPE]|([eE](\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))))?$
                          x-kubernetes-int-or-string: true
                        description: |-
                          Requests describes the minimum amount of compute resources required.
                          If Requests is omitted for a container, it defaults to Limits if that is explicitly specified,
                          otherwise to an implementation-defined value. Requests cannot exceed Limits.
                          More info: https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/
                        type: object
                    type: object
                  resourceQuota:
                    additionalProperties:
                      type: string
                    description: Resource quotas
                    type: object
                type: object
              resourceRequirements:
                description: ResourceRequirements specifies resource requirements
                properties:
                  cpu:
                    description: CPU requirements
                    type: string
                  memory:
                    description: Memory requirements
                    type: string
                  resources:
                    description: Kubernetes resource requirements
                    properties:
                      claims:
                        description: |-
                          Claims lists the names of resources, defined in spec.resourceClaims,
                          that are used by this container.

                          This is an alpha field and requires enabling the
                          DynamicResourceAllocation feature gate.

                          This field is immutable. It can only be set for containers.
                        items:
                          description: ResourceClaim references one entry in PodSpec.ResourceClaims.
                          properties:
                            name:
                              description: |-
                                Name must match the name of one entry in pod.spec.resourceClaims of
                                the Pod where this field is used. It makes that resource available
                                inside a container.
                              type: string
                            request:
                              description: |-
                                Request is the name chosen for a request in the referenced claim.
                                If empty, everything from the claim is made available, otherwise
                                only the result of this request.
                              type: string
                          required:
                          - name
                          type: object
                        type: array
                        x-kubernetes-list-map-keys:
                        - name
                        x-kubernetes-list-type: map
                      limits:
                        additionalProperties:
                          anyOf:
                          - type: integer
                          - type: string
                          pattern: ^(\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))(([KMGTPE]i)|[numkMGTPE]|([eE](\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))))?$
                          x-kubernetes-int-or-string: true
                        description: |-
                          Limits describes the maximum amount of compute resources allowed.
                          More info: https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/
                        type: object
                      requests:
                        additionalProperties:
                          anyOf:
                          - type: integer
                          - type: string
                          pattern: ^(\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))(([KMGTPE]i)|[numkMGTPE]|([eE](\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))))?$
                          x-kubernetes-int-or-string: true
                        description: |-
                          Requests describes the minimum amount of compute resources required.
                          If Requests is omitted for a container, it defaults to Limits if that is explicitly specified,
                          otherwise to an implementation-defined value. Requests cannot exceed Limits.
                          More info: https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/
                        type: object
                    type: object
                  storage:
                    description: Storage requirements
                    type: string
                type: object
              targetCluster:
                description: TargetCluster specifies the target cluster for deployment
                type: string
              targetComponents:
                description: TargetComponents specifies the target components for
                  the intent
                items:
                  description: NetworkTargetComponent represents target components
                    for network intents (to avoid conflict with disaster recovery)
                  type: string
                type: array
              targetNamespace:
                description: TargetNamespace specifies the target namespace for deployment
                type: string
              timeoutSeconds:
                description: TimeoutSeconds specifies the timeout for operations in
                  seconds
                format: int32
                type: integer
            required:
            - intent
            type: object
          status:
            description: NetworkIntentStatus defines the observed state of NetworkIntent
            properties:
              completionTime:
                description: CompletionTime indicates when the intent was completed
                format: date-time
                type: string
              conditions:
                description: Conditions represent the current conditions of the NetworkIntent
                items:
                  description: Condition contains details for one aspect of the current
                    state of this API Resource.
                  properties:
                    lastTransitionTime:
                      description: |-
                        lastTransitionTime is the last time the condition transitioned from one status to another.
                        This should be when the underlying condition changed.  If that is not known, then using the time when the API field changed is acceptable.
                      format: date-time
                      type: string
                    message:
                      description: |-
                        message is a human readable message indicating details about the transition.
                        This may be an empty string.
                      maxLength: 32768
                      type: string
                    observedGeneration:
                      description: |-
                        observedGeneration represents the .metadata.generation that the condition was set based upon.
                        For instance, if .metadata.generation is currently 12, but the .status.conditions[x].observedGeneration is 9, the condition is out of date
                        with respect to the current state of the instance.
                      format: int64
                      minimum: 0
                      type: integer
                    reason:
                      description: |-
                        reason contains a programmatic identifier indicating the reason for the condition's last transition.
                        Producers of specific condition types may define expected values and meanings for this field,
                        and whether the values are considered a guaranteed API.
                        The value should be a CamelCase string.
                        This field may not be empty.
                      maxLength: 1024
                      minLength: 1
                      pattern: ^[A-Za-z]([A-Za-z0-9_,:]*[A-Za-z0-9_])?$
                      type: string
                    status:
                      description: status of the condition, one of True, False, Unknown.
                      enum:
                      - "True"
                      - "False"
                      - Unknown
                      type: string
                    type:
                      description: type of condition in CamelCase or in foo.example.com/CamelCase.
                      maxLength: 316
                      pattern: ^([a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*/)?(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])$
                      type: string
                  required:
                  - lastTransitionTime
                  - message
                  - reason
                  - status
                  - type
                  type: object
                type: array
              deployedComponents:
                description: DeployedComponents contains the list of deployed target
                  components
                items:
                  description: NetworkTargetComponent represents target components
                    for network intents (to avoid conflict with disaster recovery)
                  type: string
                type: array
              deploymentCompletionTime:
                description: DeploymentCompletionTime indicates when deployment completed
                format: date-time
                type: string
              deploymentStatus:
                description: DeploymentStatus contains detailed deployment status
                  information
                properties:
                  completedAt:
                    description: CompletedAt timestamp when deployment completed
                    format: date-time
                    type: string
                  conditions:
                    description: Conditions current deployment conditions
                    items:
                      description: Condition contains details for one aspect of the
                        current state of this API Resource.
                      properties:
                        lastTransitionTime:
                          description: |-
                            lastTransitionTime is the last time the condition transitioned from one status to another.
                            This should be when the underlying condition changed.  If that is not known, then using the time when the API field changed is acceptable.
                          format: date-time
                          type: string
                        message:
                          description: |-
                            message is a human readable message indicating details about the transition.
                            This may be an empty string.
                          maxLength: 32768
                          type: string
                        observedGeneration:
                          description: |-
                            observedGeneration represents the .metadata.generation that the condition was set based upon.
                            For instance, if .metadata.generation is currently 12, but the .status.conditions[x].observedGeneration is 9, the condition is out of date
                            with respect to the current state of the instance.
                          format: int64
                          minimum: 0
                          type: integer
                        reason:
                          description: |-
                            reason contains a programmatic identifier indicating the reason for the condition's last transition.
                            Producers of specific condition types may define expected values and meanings for this field,
                            and whether the values are considered a guaranteed API.
                            The value should be a CamelCase string.
                            This field may not be empty.
                          maxLength: 1024
                          minLength: 1
                          pattern: ^[A-Za-z]([A-Za-z0-9_,:]*[A-Za-z0-9_])?$
                          type: string
                        status:
                          description: status of the condition, one of True, False,
                            Unknown.
                          enum:
                          - "True"
                          - "False"
                          - Unknown
                          type: string
                        type:
                          description: type of condition in CamelCase or in foo.example.com/CamelCase.
                          maxLength: 316
                          pattern: ^([a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*/)?(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])$
                          type: string
                      required:
                      - lastTransitionTime
                      - message
                      - reason
                      - status
                      - type
                      type: object
                    type: array
                  phase:
                    description: Phase current phase of deployment
                    type: string
                  startedAt:
                    description: StartedAt timestamp when deployment started
                    format: date-time
                    type: string
                  targets:
                    description: Targets list of deployment target statuses
                    items:
                      description: DeploymentTargetStatus represents the deployment
                        status for a specific target
                      properties:
                        cluster:
                          description: Cluster name of the target cluster
                          type: string
                        lastUpdateTime:
                          description: LastUpdateTime when this status was last updated
                          format: date-time
                          type: string
                        message:
                          description: Message optional status message
                          type: string
                        namespace:
                          description: Namespace target namespace
                          type: string
                        resources:
                          description: Resources deployed resources for this target
                          items:
                            description: DeployedResourceStatus contains status of
                              a deployed resource
                            properties:
                              apiVersion:
                                description: APIVersion of the resource
                                type: string
                              createdAt:
                                description: CreatedAt is the creation time
                                format: date-time
                                type: string
                              health:
                                description: Health is the resource health
                                type: string
                              kind:
                                description: Kind of the resource
                                type: string
                              message:
                                description: Message contains status message
                                type: string
                              name:
                                description: Name of the resource
                                type: string
                              namespace:
                                description: Namespace of the resource
                                type: string
                              status:
                                description: Status is the resource status
                                type: string
                              syncWave:
                                description: SyncWave is the sync wave of the resource
                                type: integer
                              uid:
                                description: UID of the resource
                                type: string
                            required:
                            - apiVersion
                            - kind
                            - name
                            - status
                            type: object
                          type: array
                        status:
                          description: Status deployment status for this target
                          type: string
                      required:
                      - cluster
                      - namespace
                      - status
                      type: object
                    type: array
                type: object
              errorMessage:
                description: ErrorMessage contains error details if the intent failed
                type: string
              extensions:
                description: Extensions contains custom extension data as raw JSON
                type: object
                x-kubernetes-preserve-unknown-fields: true
              generatedManifests:
                description: GeneratedManifests contains list of generated manifest
                  files
                items:
                  type: string
                type: array
              gitCommitHash:
                description: GitCommitHash contains the hash of the commit created
                  in GitOps repository
                type: string
              lastMessage:
                description: LastMessage contains the last status message
                type: string
              lastProcessed:
                description: LastProcessed indicates when the intent was last processed
                format: date-time
                type: string
              lastUpdateTime:
                description: LastUpdateTime indicates when the status was last updated
                format: date-time
                type: string
              lastUpdated:
                description: LastUpdated indicates when the status was last updated
                  (alias for controller compatibility)
                format: date-time
                type: string
              llmResponse:
                description: LLMResponse contains the response from the LLM processing
                type: string
              message:
                description: Message contains the current status message (alias for
                  LastMessage for controller compatibility)
                type: string
              observedGeneration:
                description: ObservedGeneration reflects the generation of the most
                  recently observed NetworkIntent
                format: int64
                type: integer
              packageRevision:
                description: PackageRevision contains reference to the generated package
                  revision
                properties:
                  packageName:
                    description: PackageName name of the package
                    type: string
                  repository:
                    description: Repository name where the package is stored
                    type: string
                  revision:
                    description: Revision specific revision of the package
                    type: string
                  workspaceName:
                    description: WorkspaceName name of the workspace (optional)
                    type: string
                required:
                - packageName
                - repository
                - revision
                type: object
              phase:
                description: Phase represents the current phase of the NetworkIntent
                  processing
                type: string
              processingCompletionTime:
                description: ProcessingCompletionTime indicates when processing completed
                format: date-time
                type: string
              processingPhase:
                description: ProcessingPhase represents the current processing phase
                  (used by controllers)
                type: string
              processingResults:
                description: ProcessingResults contains structured processing results
                properties:
                  confidenceScore:
                    description: ConfidenceScore indicates the confidence level of
                      the processing (0-1)
                    type: number
                  deploymentParameters:
                    additionalProperties:
                      type: string
                    description: DeploymentParameters contains extracted deployment
                      parameters
                    type: object
                  llmResponse:
                    description: LLMResponse contains the response from the LLM processing
                    type: string
                  networkFunctionType:
                    description: NetworkFunctionType identifies the detected network
                      function type
                    type: string
                  processingTime:
                    description: ProcessingTime indicates how long the processing
                      took
                    type: string
                type: object
              processingStartTime:
                description: ProcessingStartTime indicates when processing started
                format: date-time
                type: string
              resourcePlan:
                description: ResourcePlan contains the generated resource deployment
                  plan
                properties:
                  dependencies:
                    description: Dependencies between resources
                    items:
                      description: NetworkResourceDependency represents dependency
                        between resources
                      properties:
                        source:
                          description: Source resource name
                          type: string
                        target:
                          description: Target resource name
                          type: string
                        type:
                          description: Dependency type
                          type: string
                      required:
                      - source
                      - target
                      - type
                      type: object
                    type: array
                  estimatedCost:
                    description: Estimated cost
                    properties:
                      cpuCostPerHour:
                        description: CPU cost per hour
                        type: number
                      memoryCostPerHour:
                        description: Memory cost per hour
                        type: number
                      storageCostPerHour:
                        description: Storage cost per hour
                        type: number
                      totalCostPerHour:
                        description: Total estimated cost per hour
                        type: number
                    type: object
                  phases:
                    description: Deployment phases
                    items:
                      description: NetworkDeploymentPhase represents a deployment
                        phase
                      properties:
                        name:
                          description: Name of the phase
                          type: string
                        order:
                          description: Phase order
                          type: integer
                        resources:
                          description: Resources to deploy in this phase
                          items:
                            type: string
                          type: array
                      required:
                      - name
                      - order
                      - resources
                      type: object
                    type: array
                  resources:
                    description: Resources to be deployed
                    items:
                      description: NetworkPlannedResource represents a resource to
                        be deployed
                      properties:
                        configuration:
                          description: Configuration for the resource
                          type: object
                          x-kubernetes-preserve-unknown-fields: true
                        name:
                          description: Name of the resource
                          type: string
                        status:
                          description: Status of the resource
                          type: string
                        targetCluster:
                          description: Target cluster
                          type: string
                        type:
                          description: Type of resource (e.g., "CNF", "VNF", "Service")
                          type: string
                      required:
                      - name
                      - type
                      type: object
                    type: array
                type: object
              validationErrors:
                description: ValidationErrors contains any validation errors
                items:
                  type: string
                type: array
            type: object
        type: object
    served: true
    storage: true
    subresources:
      status: {}
