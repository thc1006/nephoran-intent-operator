---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.18.0
  name: intentprocessings.nephoran.com
spec:
  group: nephoran.com
  names:
    kind: IntentProcessing
    listKind: IntentProcessingList
    plural: intentprocessings
    shortNames:
    - ip
    - intentproc
    singular: intentprocessing
  scope: Namespaced
  versions:
  - additionalPrinterColumns:
    - jsonPath: .spec.parentIntentRef.name
      name: Parent Intent
      type: string
    - jsonPath: .status.phase
      name: Phase
      type: string
    - jsonPath: .spec.priority
      name: Priority
      type: string
    - jsonPath: .status.retryCount
      name: Retries
      type: integer
    - jsonPath: .status.processingDuration
      name: Duration
      type: string
    - jsonPath: .metadata.creationTimestamp
      name: Age
      type: date
    name: v1
    schema:
      openAPIV3Schema:
        description: IntentProcessing is the Schema for the intentprocessings API
        properties:
          apiVersion:
            description: |-
              APIVersion defines the versioned schema of this representation of an object.
              Servers should convert recognized schemas to the latest internal value, and
              may reject unrecognized values.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
            type: string
          kind:
            description: |-
              Kind is a string value representing the REST resource this object represents.
              Servers may infer this from the endpoint the client submits requests to.
              Cannot be updated.
              In CamelCase.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
            type: string
          metadata:
            type: object
          spec:
            description: IntentProcessingSpec defines the desired state of IntentProcessing
            properties:
              contextEnrichment:
                default: true
                description: ContextEnrichment enables RAG-based context enrichment
                type: boolean
              maxRetries:
                default: 3
                description: MaxRetries defines maximum retry attempts
                format: int32
                maximum: 10
                minimum: 0
                type: integer
              originalIntent:
                description: OriginalIntent contains the raw natural language intent
                maxLength: 10000
                minLength: 10
                type: string
              outputFormat:
                default: structured
                description: OutputFormat specifies the expected output format
                enum:
                - structured
                - json
                - yaml
                type: string
              parentIntentRef:
                description: ParentIntentRef references the parent NetworkIntent
                properties:
                  apiVersion:
                    description: APIVersion of the referent
                    type: string
                  fieldPath:
                    description: FieldPath refers to a field within the object
                    type: string
                  kind:
                    description: Kind of the referent
                    type: string
                  name:
                    description: Name of the referent
                    type: string
                  namespace:
                    description: Namespace of the referent; only applicable for namespaced
                      resources
                    type: string
                  resourceVersion:
                    description: ResourceVersion of the referent
                    type: string
                  uid:
                    description: UID of the referent
                    type: string
                required:
                - apiVersion
                - kind
                - name
                type: object
              priority:
                default: medium
                description: Priority defines processing priority
                enum:
                - low
                - normal
                - medium
                - high
                - critical
                type: string
              processingConfiguration:
                description: ProcessingConfiguration contains LLM processing configuration
                properties:
                  contextWindow:
                    default: 8192
                    description: ContextWindow defines the context window size
                    format: int32
                    type: integer
                  maxTokens:
                    default: 2048
                    description: MaxTokens limits the response length
                    format: int32
                    maximum: 8192
                    minimum: 100
                    type: integer
                  model:
                    default: gpt-4o-mini
                    description: Model specifies the model to use within the provider
                    type: string
                  provider:
                    default: openai
                    description: Provider specifies the LLM provider to use
                    type: string
                  ragConfiguration:
                    description: RAGConfiguration contains RAG-specific settings
                    properties:
                      embeddingModel:
                        default: text-embedding-3-large
                        description: EmbeddingModel specifies the embedding model
                          for RAG
                        type: string
                      enabled:
                        default: true
                        description: Enabled determines if RAG is enabled
                        type: boolean
                      knowledgeBase:
                        default: telecom-default
                        description: KnowledgeBase specifies the knowledge base to
                          use
                        type: string
                      maxDocuments:
                        default: 5
                        description: MaxDocuments limits the number of retrieved documents
                        format: int32
                        maximum: 20
                        minimum: 1
                        type: integer
                      retrievalThreshold:
                        default: 0.7
                        description: RetrievalThreshold sets the minimum similarity
                          threshold
                        type: number
                    type: object
                  systemPrompt:
                    description: SystemPrompt provides system-level instructions
                    type: string
                  temperature:
                    default: 0.1
                    description: Temperature controls randomness in generation
                    type: number
                type: object
              timeoutSeconds:
                default: 120
                description: Timeout for processing in seconds
                format: int32
                maximum: 1800
                minimum: 30
                type: integer
            required:
            - originalIntent
            - parentIntentRef
            type: object
          status:
            description: IntentProcessingStatus defines the observed state of IntentProcessing
            properties:
              conditions:
                description: Conditions represent the latest available observations
                items:
                  description: Condition contains details for one aspect of the current
                    state of this API Resource.
                  properties:
                    lastTransitionTime:
                      description: |-
                        lastTransitionTime is the last time the condition transitioned from one status to another.
                        This should be when the underlying condition changed.  If that is not known, then using the time when the API field changed is acceptable.
                      format: date-time
                      type: string
                    message:
                      description: |-
                        message is a human readable message indicating details about the transition.
                        This may be an empty string.
                      maxLength: 32768
                      type: string
                    observedGeneration:
                      description: |-
                        observedGeneration represents the .metadata.generation that the condition was set based upon.
                        For instance, if .metadata.generation is currently 12, but the .status.conditions[x].observedGeneration is 9, the condition is out of date
                        with respect to the current state of the instance.
                      format: int64
                      minimum: 0
                      type: integer
                    reason:
                      description: |-
                        reason contains a programmatic identifier indicating the reason for the condition's last transition.
                        Producers of specific condition types may define expected values and meanings for this field,
                        and whether the values are considered a guaranteed API.
                        The value should be a CamelCase string.
                        This field may not be empty.
                      maxLength: 1024
                      minLength: 1
                      pattern: ^[A-Za-z]([A-Za-z0-9_,:]*[A-Za-z0-9_])?$
                      type: string
                    status:
                      description: status of the condition, one of True, False, Unknown.
                      enum:
                      - "True"
                      - "False"
                      - Unknown
                      type: string
                    type:
                      description: type of condition in CamelCase or in foo.example.com/CamelCase.
                      maxLength: 316
                      pattern: ^([a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*/)?(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])$
                      type: string
                  required:
                  - lastTransitionTime
                  - message
                  - reason
                  - status
                  - type
                  type: object
                type: array
                x-kubernetes-list-map-keys:
                - type
                x-kubernetes-list-type: map
              extractedEntities:
                additionalProperties:
                  type: string
                description: ExtractedEntities contains telecommunications entities
                type: object
              lastRetryTime:
                description: LastRetryTime indicates the last retry attempt
                format: date-time
                type: string
              llmResponse:
                description: LLMResponse contains the processed response from the
                  LLM
                type: object
                x-kubernetes-preserve-unknown-fields: true
              observedGeneration:
                description: ObservedGeneration reflects the generation observed
                format: int64
                type: integer
              phase:
                description: Phase represents the current processing phase
                type: string
              processedParameters:
                description: ProcessedParameters contains structured parameters
                properties:
                  customParameters:
                    additionalProperties:
                      type: string
                    description: CustomParameters contains additional custom parameters
                    type: object
                  networkFunction:
                    description: NetworkFunction specifies the network function type
                    type: string
                  qosParameters:
                    description: QoSParameters contains quality of service settings
                    properties:
                      bandwidth:
                        description: Bandwidth specifies the bandwidth requirement
                        type: string
                      latency:
                        description: Latency specifies the target latency requirement
                        type: string
                      priority:
                        description: Priority specifies the traffic priority
                        enum:
                        - low
                        - medium
                        - high
                        - critical
                        type: string
                      serviceLevel:
                        description: ServiceLevel specifies the service level agreement
                        type: string
                    type: object
                  region:
                    description: Region specifies the deployment region
                    type: string
                  scaleParameters:
                    description: ScaleParameters contains scaling configuration
                    properties:
                      autoScalingEnabled:
                        description: AutoScalingEnabled indicates if auto-scaling
                          is enabled
                        type: boolean
                      maxReplicas:
                        description: MaxReplicas specifies the maximum number of replicas
                        format: int32
                        minimum: 1
                        type: integer
                      minReplicas:
                        description: MinReplicas specifies the minimum number of replicas
                        format: int32
                        minimum: 1
                        type: integer
                      targetCPUUtilization:
                        description: TargetCPUUtilization specifies the target CPU
                          utilization percentage
                        format: int32
                        maximum: 100
                        minimum: 1
                        type: integer
                    type: object
                  securityParameters:
                    description: SecurityParameters contains security settings
                    properties:
                      encryption:
                        description: Encryption specifies encryption requirements
                        properties:
                          algorithm:
                            description: Algorithm specifies the encryption algorithm
                            enum:
                            - AES-256
                            - AES-128
                            - RSA-2048
                            - RSA-4096
                            type: string
                          enabled:
                            description: Enabled indicates if encryption is enabled
                            type: boolean
                          keyRotationInterval:
                            description: KeyRotationInterval specifies the key rotation
                              interval
                            type: string
                        type: object
                      networkPolicies:
                        description: NetworkPolicies specifies network security policies
                        items:
                          type: string
                        type: array
                      serviceMesh:
                        description: ServiceMesh indicates if service mesh should
                          be enabled
                        type: boolean
                      tlsEnabled:
                        description: TLSEnabled indicates if TLS should be enabled
                        type: boolean
                    type: object
                type: object
              processingCompletionTime:
                description: ProcessingCompletionTime indicates when processing completed
                format: date-time
                type: string
              processingDuration:
                description: ProcessingDuration represents total processing time
                type: string
              processingStartTime:
                description: ProcessingStartTime indicates when processing started
                format: date-time
                type: string
              qualityScore:
                description: QualityScore represents the quality of processing
                maximum: 1
                minimum: 0
                type: number
              ragMetrics:
                description: RAGMetrics contains retrieval-augmented generation metrics
                properties:
                  averageRelevanceScore:
                    description: AverageRelevanceScore is the average relevance of
                      retrieved docs
                    type: number
                  documentsRetrieved:
                    description: DocumentsRetrieved is the number of documents retrieved
                    format: int32
                    type: integer
                  knowledgeBase:
                    description: KnowledgeBase used for retrieval
                    type: string
                  queryEnhancement:
                    description: QueryEnhancement indicates if query was enhanced
                    type: boolean
                  retrievalDuration:
                    description: RetrievalDuration is the time taken to retrieve documents
                    type: string
                  topRelevanceScore:
                    description: TopRelevanceScore is the highest relevance score
                    type: number
                required:
                - averageRelevanceScore
                - documentsRetrieved
                - knowledgeBase
                - queryEnhancement
                - retrievalDuration
                - topRelevanceScore
                type: object
              retryCount:
                description: RetryCount tracks the number of retry attempts
                format: int32
                type: integer
              telecomContext:
                description: TelecomContext contains domain-specific context
                type: object
                x-kubernetes-preserve-unknown-fields: true
              tokenUsage:
                description: TokenUsage tracks token consumption
                properties:
                  completionTokens:
                    description: CompletionTokens used for the response
                    format: int32
                    type: integer
                  estimatedCost:
                    description: EstimatedCost in USD
                    type: number
                  model:
                    description: Model used for processing
                    type: string
                  promptTokens:
                    description: PromptTokens used for the prompt
                    format: int32
                    type: integer
                  provider:
                    description: Provider used for processing
                    type: string
                  totalTokens:
                    description: TotalTokens used in total
                    format: int32
                    type: integer
                required:
                - completionTokens
                - model
                - promptTokens
                - provider
                - totalTokens
                type: object
              validationErrors:
                description: ValidationErrors contains any validation errors
                items:
                  type: string
                type: array
            type: object
        type: object
    served: true
    storage: true
    subresources:
      status: {}
