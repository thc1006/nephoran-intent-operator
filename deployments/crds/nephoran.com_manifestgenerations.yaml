---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.18.0
  name: manifestgenerations.nephoran.com
spec:
  group: nephoran.com
  names:
    kind: ManifestGeneration
    listKind: ManifestGenerationList
    plural: manifestgenerations
    shortNames:
    - mg
    - manigen
    singular: manifestgeneration
  scope: Namespaced
  versions:
  - additionalPrinterColumns:
    - jsonPath: .spec.parentIntentRef.name
      name: Parent Intent
      type: string
    - jsonPath: .status.phase
      name: Phase
      type: string
    - jsonPath: .spec.templateEngine
      name: Engine
      type: string
    - jsonPath: .status.manifestSummary.totalManifests
      name: Manifests
      type: integer
    - jsonPath: .status.qualityScore
      name: Quality
      type: string
    - jsonPath: .status.securityAnalysis.overallScore
      name: Security
      type: string
    - jsonPath: .metadata.creationTimestamp
      name: Age
      type: date
    name: v1
    schema:
      openAPIV3Schema:
        description: ManifestGeneration is the Schema for the manifestgenerations
          API
        properties:
          apiVersion:
            description: |-
              APIVersion defines the versioned schema of this representation of an object.
              Servers should convert recognized schemas to the latest internal value, and
              may reject unrecognized values.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
            type: string
          kind:
            description: |-
              Kind is a string value representing the REST resource this object represents.
              Servers may infer this from the endpoint the client submits requests to.
              Cannot be updated.
              In CamelCase.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
            type: string
          metadata:
            type: object
          spec:
            description: ManifestGenerationSpec defines the desired state of ManifestGeneration
            properties:
              generationOptions:
                description: GenerationOptions contains options for manifest generation
                properties:
                  annotations:
                    additionalProperties:
                      type: string
                    description: Annotations to apply to all generated manifests
                    type: object
                  generateHealthChecks:
                    default: true
                    description: GenerateHealthChecks includes health check configurations
                    type: boolean
                  generateMonitoring:
                    default: true
                    description: GenerateMonitoring includes monitoring-related manifests
                    type: boolean
                  includeNamespaces:
                    default: true
                    description: IncludeNamespaces generates namespace manifests
                    type: boolean
                  includeNetworkPolicies:
                    default: false
                    description: IncludeNetworkPolicies generates NetworkPolicy manifests
                    type: boolean
                  includePodSecurityPolicies:
                    default: false
                    description: IncludePodSecurityPolicies generates PodSecurityPolicy
                      manifests
                    type: boolean
                  includeRBAC:
                    default: true
                    description: IncludeRBAC generates RBAC manifests
                    type: boolean
                  labels:
                    additionalProperties:
                      type: string
                    description: Labels to apply to all generated manifests
                    type: object
                  resourceNaming:
                    description: ResourceNaming defines naming conventions
                    properties:
                      includeComponent:
                        default: true
                        description: IncludeComponent includes the component name
                          in resource names
                        type: boolean
                      includeIntentName:
                        default: true
                        description: IncludeIntentName includes the intent name in
                          resource names
                        type: boolean
                      maxLength:
                        default: 63
                        description: MaxLength limits the maximum name length
                        maximum: 253
                        minimum: 1
                        type: integer
                      prefix:
                        description: Prefix for all resource names
                        type: string
                      suffix:
                        description: Suffix for all resource names
                        type: string
                    type: object
                type: object
              namespaceTemplate:
                description: NamespaceTemplate defines template for namespace creation
                properties:
                  annotations:
                    additionalProperties:
                      type: string
                    description: Annotations to apply to the namespace
                    type: object
                  labels:
                    additionalProperties:
                      type: string
                    description: Labels to apply to the namespace
                    type: object
                  nameTemplate:
                    description: Name template for the namespace
                    type: string
                  networkPolicy:
                    description: NetworkPolicy for the namespace
                    type: object
                    x-kubernetes-preserve-unknown-fields: true
                  resourceQuota:
                    description: ResourceQuota for the namespace
                    type: object
                    x-kubernetes-preserve-unknown-fields: true
                type: object
              optimizeManifests:
                default: true
                description: OptimizeManifests enables manifest optimization
                type: boolean
              outputFormat:
                default: yaml
                description: OutputFormat specifies the output format for manifests
                enum:
                - yaml
                - json
                type: string
              parentIntentRef:
                description: ParentIntentRef references the parent NetworkIntent
                properties:
                  apiVersion:
                    description: APIVersion of the referent
                    type: string
                  fieldPath:
                    description: FieldPath refers to a field within the object
                    type: string
                  kind:
                    description: Kind of the referent
                    type: string
                  name:
                    description: Name of the referent
                    type: string
                  namespace:
                    description: Namespace of the referent; only applicable for namespaced
                      resources
                    type: string
                  resourceVersion:
                    description: ResourceVersion of the referent
                    type: string
                  uid:
                    description: UID of the referent
                    type: string
                required:
                - apiVersion
                - kind
                - name
                type: object
              priority:
                default: medium
                description: Priority defines generation priority
                enum:
                - low
                - normal
                - medium
                - high
                - critical
                type: string
              resourcePlanInput:
                description: ResourcePlanInput contains the resource plan for generation
                type: object
                x-kubernetes-preserve-unknown-fields: true
              resourcePlanRef:
                description: ResourcePlanRef references the ResourcePlan resource
                properties:
                  apiVersion:
                    description: APIVersion of the referent
                    type: string
                  fieldPath:
                    description: FieldPath refers to a field within the object
                    type: string
                  kind:
                    description: Kind of the referent
                    type: string
                  name:
                    description: Name of the referent
                    type: string
                  namespace:
                    description: Namespace of the referent; only applicable for namespaced
                      resources
                    type: string
                  resourceVersion:
                    description: ResourceVersion of the referent
                    type: string
                  uid:
                    description: UID of the referent
                    type: string
                required:
                - apiVersion
                - kind
                - name
                type: object
              securityContext:
                description: SecurityContext defines security context for manifests
                properties:
                  addCapabilities:
                    description: AddCapabilities specifies capabilities to add
                    items:
                      type: string
                    type: array
                  allowPrivilegeEscalation:
                    default: false
                    description: AllowPrivilegeEscalation controls privilege escalation
                    type: boolean
                  dropCapabilities:
                    description: DropCapabilities specifies capabilities to drop
                    items:
                      type: string
                    type: array
                  readOnlyRootFilesystem:
                    default: true
                    description: ReadOnlyRootFilesystem makes root filesystem read-only
                    type: boolean
                  runAsNonRoot:
                    default: true
                    description: RunAsNonRoot ensures containers run as non-root
                    type: boolean
                  seLinuxOptions:
                    description: SeLinuxOptions specifies SELinux options
                    type: object
                    x-kubernetes-preserve-unknown-fields: true
                  seccompProfile:
                    description: SeccompProfile specifies seccomp profile
                    type: string
                type: object
              templateEngine:
                default: helm
                description: TemplateEngine specifies the template engine to use
                type: string
              templateSource:
                description: TemplateSource specifies the source of templates
                properties:
                  builtinTemplates:
                    description: BuiltinTemplates for built-in templates
                    items:
                      type: string
                    type: array
                  configMapSource:
                    description: ConfigMapSource for ConfigMap-based templates
                    properties:
                      keys:
                        description: Keys to use from the ConfigMap
                        items:
                          type: string
                        type: array
                      name:
                        description: Name of the ConfigMap
                        type: string
                      namespace:
                        description: Namespace of the ConfigMap
                        type: string
                    required:
                    - name
                    type: object
                  gitSource:
                    description: GitSource for Git-based templates
                    properties:
                      branch:
                        default: main
                        description: Branch to use
                        type: string
                      path:
                        default: .
                        description: Path within the repository
                        type: string
                      secretRef:
                        description: SecretRef for authentication
                        properties:
                          key:
                            description: Key within the secret
                            type: string
                          name:
                            description: Name of the secret
                            type: string
                          namespace:
                            description: Namespace of the secret (optional, defaults
                              to same namespace as AuditTrail)
                            type: string
                        required:
                        - name
                        type: object
                      tag:
                        description: Tag to use (takes precedence over branch)
                        type: string
                      url:
                        description: URL of the Git repository
                        type: string
                    required:
                    - url
                    type: object
                  helmSource:
                    description: HelmSource for Helm chart templates
                    properties:
                      chart:
                        description: Chart name
                        type: string
                      repository:
                        description: Repository URL
                        type: string
                      secretRef:
                        description: SecretRef for authentication
                        properties:
                          key:
                            description: Key within the secret
                            type: string
                          name:
                            description: Name of the secret
                            type: string
                          namespace:
                            description: Namespace of the secret (optional, defaults
                              to same namespace as AuditTrail)
                            type: string
                        required:
                        - name
                        type: object
                      values:
                        description: Values for the chart
                        type: object
                        x-kubernetes-preserve-unknown-fields: true
                      version:
                        description: Version of the chart
                        type: string
                    required:
                    - chart
                    - repository
                    type: object
                  ociSource:
                    description: OCISource for OCI registry templates
                    properties:
                      registry:
                        description: Registry URL
                        type: string
                      repository:
                        description: Repository name
                        type: string
                      secretRef:
                        description: SecretRef for authentication
                        properties:
                          key:
                            description: Key within the secret
                            type: string
                          name:
                            description: Name of the secret
                            type: string
                          namespace:
                            description: Namespace of the secret (optional, defaults
                              to same namespace as AuditTrail)
                            type: string
                        required:
                        - name
                        type: object
                      tag:
                        default: latest
                        description: Tag or digest
                        type: string
                    required:
                    - registry
                    - repository
                    type: object
                  type:
                    description: Type specifies the source type
                    enum:
                    - git
                    - helm
                    - oci
                    - configmap
                    - builtin
                    type: string
                required:
                - type
                type: object
              validateManifests:
                default: true
                description: ValidateManifests enables manifest validation
                type: boolean
            required:
            - parentIntentRef
            - resourcePlanInput
            type: object
          status:
            description: ManifestGenerationStatus defines the observed state of ManifestGeneration
            properties:
              conditions:
                description: Conditions represent the latest available observations
                items:
                  description: Condition contains details for one aspect of the current
                    state of this API Resource.
                  properties:
                    lastTransitionTime:
                      description: |-
                        lastTransitionTime is the last time the condition transitioned from one status to another.
                        This should be when the underlying condition changed.  If that is not known, then using the time when the API field changed is acceptable.
                      format: date-time
                      type: string
                    message:
                      description: |-
                        message is a human readable message indicating details about the transition.
                        This may be an empty string.
                      maxLength: 32768
                      type: string
                    observedGeneration:
                      description: |-
                        observedGeneration represents the .metadata.generation that the condition was set based upon.
                        For instance, if .metadata.generation is currently 12, but the .status.conditions[x].observedGeneration is 9, the condition is out of date
                        with respect to the current state of the instance.
                      format: int64
                      minimum: 0
                      type: integer
                    reason:
                      description: |-
                        reason contains a programmatic identifier indicating the reason for the condition's last transition.
                        Producers of specific condition types may define expected values and meanings for this field,
                        and whether the values are considered a guaranteed API.
                        The value should be a CamelCase string.
                        This field may not be empty.
                      maxLength: 1024
                      minLength: 1
                      pattern: ^[A-Za-z]([A-Za-z0-9_,:]*[A-Za-z0-9_])?$
                      type: string
                    status:
                      description: status of the condition, one of True, False, Unknown.
                      enum:
                      - "True"
                      - "False"
                      - Unknown
                      type: string
                    type:
                      description: type of condition in CamelCase or in foo.example.com/CamelCase.
                      maxLength: 316
                      pattern: ^([a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*/)?(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])$
                      type: string
                  required:
                  - lastTransitionTime
                  - message
                  - reason
                  - status
                  - type
                  type: object
                type: array
                x-kubernetes-list-map-keys:
                - type
                x-kubernetes-list-type: map
              generatedManifests:
                additionalProperties:
                  type: string
                description: GeneratedManifests contains the generated Kubernetes
                  manifests
                type: object
              generationCompletionTime:
                description: GenerationCompletionTime indicates when generation completed
                format: date-time
                type: string
              generationDuration:
                description: GenerationDuration represents total generation time
                type: string
              generationStartTime:
                description: GenerationStartTime indicates when generation started
                format: date-time
                type: string
              manifestSummary:
                description: ManifestSummary provides a summary of generated manifests
                properties:
                  generatedNamespaces:
                    description: GeneratedNamespaces lists generated namespaces
                    items:
                      type: string
                    type: array
                  manifestsByComponent:
                    additionalProperties:
                      format: int32
                      type: integer
                    description: ManifestsByComponent breaks down manifests by component
                    type: object
                  manifestsByNamespace:
                    additionalProperties:
                      format: int32
                      type: integer
                    description: ManifestsByNamespace breaks down manifests by namespace
                    type: object
                  manifestsByType:
                    additionalProperties:
                      format: int32
                      type: integer
                    description: ManifestsByType breaks down manifests by type
                    type: object
                  totalManifests:
                    description: TotalManifests is the total number of generated manifests
                    format: int32
                    type: integer
                  totalSize:
                    description: TotalSize is the total size of all manifests in bytes
                    format: int64
                    type: integer
                required:
                - manifestsByType
                - totalManifests
                type: object
              observedGeneration:
                description: ObservedGeneration reflects the generation observed
                format: int64
                type: integer
              optimizationResults:
                description: OptimizationResults contains optimization results
                items:
                  description: ManifestOptimizationResult represents the result of
                    manifest optimization
                  properties:
                    applied:
                      description: Applied indicates if optimization was applied
                      type: boolean
                    changes:
                      description: Changes lists the changes made
                      items:
                        type: string
                      type: array
                    description:
                      description: Description describes the optimization
                      type: string
                    improvementPercent:
                      description: ImprovementPercent quantifies the improvement
                      type: number
                    manifestName:
                      description: ManifestName identifies the optimized manifest
                      type: string
                    optimizationType:
                      description: OptimizationType specifies the type of optimization
                      type: string
                    optimizedAt:
                      description: OptimizedAt timestamp
                      format: date-time
                      type: string
                  required:
                  - applied
                  - manifestName
                  - optimizationType
                  - optimizedAt
                  type: object
                type: array
              phase:
                description: Phase represents the current generation phase
                type: string
              qualityScore:
                description: QualityScore represents the quality of generated manifests
                maximum: 1
                minimum: 0
                type: number
              resourceReferences:
                description: ResourceReferences contains references to generated resources
                items:
                  description: GeneratedResourceReference represents a reference to
                    a generated resource
                  properties:
                    apiVersion:
                      description: APIVersion of the resource
                      type: string
                    component:
                      description: Component this resource belongs to
                      type: string
                    dependencies:
                      description: Dependencies lists resource dependencies
                      items:
                        type: string
                      type: array
                    kind:
                      description: Kind of the resource
                      type: string
                    manifestFile:
                      description: ManifestFile where this resource is defined
                      type: string
                    name:
                      description: Name of the resource
                      type: string
                    namespace:
                      description: Namespace of the resource
                      type: string
                  required:
                  - apiVersion
                  - kind
                  - name
                  type: object
                type: array
              retryCount:
                description: RetryCount tracks retry attempts
                format: int32
                type: integer
              securityAnalysis:
                description: SecurityAnalysis contains security analysis results
                properties:
                  analyzedAt:
                    description: AnalyzedAt timestamp
                    format: date-time
                    type: string
                  complianceResults:
                    description: ComplianceResults contains compliance check results
                    items:
                      description: SecurityComplianceResult represents compliance
                        check results
                      properties:
                        compliant:
                          description: Compliant indicates compliance status
                          type: boolean
                        score:
                          description: Score represents compliance score (0.0-1.0)
                          maximum: 1
                          minimum: 0
                          type: number
                        standard:
                          description: Standard being checked (PCI-DSS, SOC2, etc.)
                          type: string
                        version:
                          description: Version of the standard
                          type: string
                        violations:
                          description: Violations lists compliance violations
                          items:
                            type: string
                          type: array
                      required:
                      - compliant
                      - standard
                      type: object
                    type: array
                  overallScore:
                    description: OverallScore is the overall security score (0.0-1.0)
                    maximum: 1
                    minimum: 0
                    type: number
                  recommendations:
                    description: Recommendations provides security recommendations
                    items:
                      type: string
                    type: array
                  securityIssues:
                    description: SecurityIssues lists identified security issues
                    items:
                      description: SecurityIssue represents a security issue in manifests
                      properties:
                        affectedManifests:
                          description: AffectedManifests lists affected manifests
                          items:
                            type: string
                          type: array
                        cvssScore:
                          description: CVSS score if applicable
                          type: number
                        description:
                          description: Description of the issue
                          type: string
                        remediation:
                          description: Remediation suggests how to fix the issue
                          type: string
                        severity:
                          description: Severity level (Critical, High, Medium, Low)
                          type: string
                        type:
                          description: Type of security issue
                          type: string
                      required:
                      - description
                      - severity
                      - type
                      type: object
                    type: array
                required:
                - analyzedAt
                - overallScore
                type: object
              templateInfo:
                description: TemplateInfo contains information about used templates
                properties:
                  engine:
                    description: Engine used for templating
                    type: string
                  source:
                    description: Source information
                    properties:
                      builtinTemplates:
                        description: BuiltinTemplates for built-in templates
                        items:
                          type: string
                        type: array
                      configMapSource:
                        description: ConfigMapSource for ConfigMap-based templates
                        properties:
                          keys:
                            description: Keys to use from the ConfigMap
                            items:
                              type: string
                            type: array
                          name:
                            description: Name of the ConfigMap
                            type: string
                          namespace:
                            description: Namespace of the ConfigMap
                            type: string
                        required:
                        - name
                        type: object
                      gitSource:
                        description: GitSource for Git-based templates
                        properties:
                          branch:
                            default: main
                            description: Branch to use
                            type: string
                          path:
                            default: .
                            description: Path within the repository
                            type: string
                          secretRef:
                            description: SecretRef for authentication
                            properties:
                              key:
                                description: Key within the secret
                                type: string
                              name:
                                description: Name of the secret
                                type: string
                              namespace:
                                description: Namespace of the secret (optional, defaults
                                  to same namespace as AuditTrail)
                                type: string
                            required:
                            - name
                            type: object
                          tag:
                            description: Tag to use (takes precedence over branch)
                            type: string
                          url:
                            description: URL of the Git repository
                            type: string
                        required:
                        - url
                        type: object
                      helmSource:
                        description: HelmSource for Helm chart templates
                        properties:
                          chart:
                            description: Chart name
                            type: string
                          repository:
                            description: Repository URL
                            type: string
                          secretRef:
                            description: SecretRef for authentication
                            properties:
                              key:
                                description: Key within the secret
                                type: string
                              name:
                                description: Name of the secret
                                type: string
                              namespace:
                                description: Namespace of the secret (optional, defaults
                                  to same namespace as AuditTrail)
                                type: string
                            required:
                            - name
                            type: object
                          values:
                            description: Values for the chart
                            type: object
                            x-kubernetes-preserve-unknown-fields: true
                          version:
                            description: Version of the chart
                            type: string
                        required:
                        - chart
                        - repository
                        type: object
                      ociSource:
                        description: OCISource for OCI registry templates
                        properties:
                          registry:
                            description: Registry URL
                            type: string
                          repository:
                            description: Repository name
                            type: string
                          secretRef:
                            description: SecretRef for authentication
                            properties:
                              key:
                                description: Key within the secret
                                type: string
                              name:
                                description: Name of the secret
                                type: string
                              namespace:
                                description: Namespace of the secret (optional, defaults
                                  to same namespace as AuditTrail)
                                type: string
                            required:
                            - name
                            type: object
                          tag:
                            default: latest
                            description: Tag or digest
                            type: string
                        required:
                        - registry
                        - repository
                        type: object
                      type:
                        description: Type specifies the source type
                        enum:
                        - git
                        - helm
                        - oci
                        - configmap
                        - builtin
                        type: string
                    required:
                    - type
                    type: object
                  templateVersion:
                    description: TemplateVersion indicates the version of templates
                      used
                    type: string
                  templatesUsed:
                    description: TemplatesUsed lists the templates that were used
                    items:
                      type: string
                    type: array
                  variables:
                    description: Variables contains the template variables used
                    type: object
                    x-kubernetes-preserve-unknown-fields: true
                required:
                - engine
                - source
                type: object
              validationResults:
                description: ValidationResults contains validation results
                items:
                  description: ManifestValidationResult represents the result of manifest
                    validation
                  properties:
                    errors:
                      description: Errors contains validation errors
                      items:
                        type: string
                      type: array
                    manifestName:
                      description: ManifestName identifies the validated manifest
                      type: string
                    manifestType:
                      description: ManifestType specifies the type of manifest
                      type: string
                    valid:
                      description: Valid indicates if the manifest is valid
                      type: boolean
                    validatedAt:
                      description: ValidatedAt timestamp
                      format: date-time
                      type: string
                    validationRules:
                      description: ValidationRules lists which validation rules were
                        applied
                      items:
                        type: string
                      type: array
                    warnings:
                      description: Warnings contains validation warnings
                      items:
                        type: string
                      type: array
                  required:
                  - manifestName
                  - manifestType
                  - valid
                  - validatedAt
                  type: object
                type: array
            type: object
        type: object
    served: true
    storage: true
    subresources:
      status: {}
